-- DROP TABLE IF EXISTS CUSTOMER_TABLE;
CREATE TABLE CUSTOMER_TABLE (FIRSTNAME VARCHAR(100),
                             LASTNAME VARCHAR(100),
	                         AGE INT);

INSERT INTO CUSTOMER_TABLE (FIRSTNAME, LASTNAME, AGE) 
VALUES ('VISHAL', 'RAJ', 28);
INSERT INTO CUSTOMER_TABLE (FIRSTNAME, LASTNAME, AGE) 
VALUES ('ROMITA', 'NAYAK', 26);
INSERT INTO CUSTOMER_TABLE (FIRSTNAME, LASTNAME, AGE) 
VALUES ('ARPITA', 'GA', 25);
INSERT INTO CUSTOMER_TABLE (FIRSTNAME, LASTNAME, AGE) 
VALUES ('AKHILA', 'MULLICK', 24);
INSERT INTO CUSTOMER_TABLE (FIRSTNAME, LASTNAME, AGE) 
VALUES ('NIVESH', 'SINGH', 24);

SELECT *
FROM CUSTOMER_TABLE;

SELECT *
FROM CUSTOMER_TABLE
WHERE FIRSTNAME = 'ARPITA';

SELECT *
FROM CUSTOMER_TABLE
WHERE FIRSTNAME = 'ARPITA' OR LASTNAME = 'NAYAK';

SELECT *
FROM CUSTOMER_TABLE
WHERE FIRSTNAME = 'AKHILA' OR AGE > 24;

SELECT *
FROM CUSTOMER_TABLE
WHERE FIRSTNAME = 'VISHAL' OR LASTNAME LIKE 'S%';

SELECT *
FROM CUSTOMER_TABLE
WHERE AGE BETWEEN 26 AND 29;

UPDATE CUSTOMER_TABLE 
SET LASTNAME = 'NAYAK'
WHERE FIRSTNAME = 'ARPITA';

UPDATE CUSTOMER_TABLE 
SET LASTNAME = 'RASTOGI'
WHERE FIRSTNAME = 'NIVESH';

DELETE FROM CUSTOMER_TABLE
WHERE LASTNAME = 'RASTOGI';

TRUNCATE TABLE CUSTOMER_TABLE;

DROP TABLE CUSTOMER_TABLE;

ALTER TABLE CUSTOMER_TABLE
ADD CITY VARCHAR(50);

UPDATE CUSTOMER_TABLE 
SET CITY = 'GURGAON';

UPDATE CUSTOMER_TABLE
SET CITY = 'NOIDA'
WHERE FIRSTNAME = 'NIVESH';

UPDATE CUSTOMER_TABLE
SET CITY = 'KOLKATA'
WHERE FIRSTNAME = 'ROMITA';

UPDATE CUSTOMER_TABLE
SET CITY = 'KOCHI'
WHERE FIRSTNAME = 'AKHILA';

DROP TABLE IF EXISTS CUSTOMER_TABLE;

CREATE TABLE CUSTOMER_TABLE (ID INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
							 FIRSTNAME VARCHAR(100),
							 LASTNAME VARCHAR(100),
							 AGE INT,
							 CITY VARCHAR(50));

INSERT INTO CUSTOMER_TABLE (FIRSTNAME, LASTNAME, AGE, CITY) 
VALUES ('VISHAL', 'RAJ', 28, 'GURGAON');
INSERT INTO CUSTOMER_TABLE (FIRSTNAME, LASTNAME, AGE, CITY) 
VALUES ('ROMITA', 'NAYAK', 26, 'KOLKATA');
INSERT INTO CUSTOMER_TABLE (FIRSTNAME, LASTNAME, AGE, CITY) 
VALUES ('ARPITA', 'GA', 25, 'KANPUR');
INSERT INTO CUSTOMER_TABLE (FIRSTNAME, LASTNAME, AGE, CITY) 
VALUES ('AKHILA', 'MULLICK', 24, 'DISPUR');
INSERT INTO CUSTOMER_TABLE (FIRSTNAME, LASTNAME, AGE, CITY) 
VALUES ('NIVESH', 'SINGH', 24, 'NOIDA');

SELECT *
FROM CUSTOMER_TABLE;

DROP TABLE IF EXISTS PRODUCT_TABLE; 

CREATE TABLE PRODUCT_TABLE (PRODUCT_ID INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
	                        PRODUCTNAME VARCHAR(50))

ALTER TABLE PRODUCT_TABLE
ADD PRICE FLOAT;

INSERT INTO PRODUCT_TABLE (PRODUCTNAME, PRICE) VALUES ('BASEBALL', NULL);
INSERT INTO PRODUCT_TABLE (PRODUCTNAME, PRICE) VALUES ('BAT', 920.35);
INSERT INTO PRODUCT_TABLE (PRODUCTNAME, PRICE) VALUES ('MOBILE', 8500.24);
INSERT INTO PRODUCT_TABLE (PRODUCTNAME, PRICE) VALUES ('PAINT', 340.87);
INSERT INTO PRODUCT_TABLE (PRODUCTNAME, PRICE) VALUES ('BOOK', 240.00);

SELECT *
FROM PRODUCT_TABLE;

DROP TABLE IF EXISTS ORDER_TABLE; 

CREATE TABLE ORDER_TABLE (ORDER_ID  INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
						  ORDERDATE DATE,
						  CUSTOMER_ID INT,
						  PRODUCT_ID INT)

SELECT *
FROM CUSTOMER_TABLE;
SELECT *
FROM PRODUCT_TABLE;
SELECT *
FROM ORDER_TABLE;

INSERT INTO ORDER_TABLE (ORDERDATE, CUSTOMER_ID, PRODUCT_ID) VALUES (NOW(), 5, 5);
INSERT INTO ORDER_TABLE (ORDERDATE, CUSTOMER_ID, PRODUCT_ID) VALUES (NOW(), 2, 4);
INSERT INTO ORDER_TABLE (ORDERDATE, CUSTOMER_ID, PRODUCT_ID) VALUES (NOW(), 4, 5);
INSERT INTO ORDER_TABLE (ORDERDATE, CUSTOMER_ID, PRODUCT_ID) VALUES (NOW(), 3, 1);
INSERT INTO ORDER_TABLE (ORDERDATE, CUSTOMER_ID, PRODUCT_ID) VALUES (NOW(), 1, 3);

ALTER TABLE ORDER_TABLE
ADD FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER_TABLE(ID); 

ALTER TABLE ORDER_TABLE
ADD FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCT_TABLE(PRODUCT_ID); 

SELECT CT.CITY, CT.LASTNAME, SUM(PT.PRICE) AS TOTAL
FROM CUSTOMER_TABLE CT
LEFT JOIN ORDER_TABLE OT
ON CT.ID = OT.CUSTOMER_ID
LEFT JOIN PRODUCT_TABLE PT
ON OT.PRODUCT_ID = PT.PRODUCT_ID
GROUP BY CITY, LASTNAME;